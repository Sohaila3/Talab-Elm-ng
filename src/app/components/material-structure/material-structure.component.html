<div class="min-h-[900px] w-full bg-[#F5F7FA] font-['Cairo'] flex flex-col">

    <!-- Main Body -->
    <main class="flex-1 p-10 overflow-y-auto">
        <div class="max-w-[1200px] mx-auto pb-20">

            <!-- Page Title & Actions -->
            <div class="flex items-start justify-between mb-10">
                <div>
                    <h1 class="text-[32px] font-black text-[#0F172A] mb-2 leading-tight">
                        {{ 'MATERIAL_STRUCTURE' | translate }}: {{ materialName }}
                    </h1>
                    <p class="text-[#64748B] text-lg font-medium">
                        {{ 'MANAGE_STRUCTURE_DESC' | translate }}
                    </p>
                </div>

                <div class="flex items-center gap-3">

                    <button (click)="toggleAddForm()"
                        [class]="showAddForm || showEditForm
                            ? 'h-11 px-6 rounded-xl font-bold text-sm bg-[#EFF6FF] text-[#1877F2] hover:bg-[#DBEAFE] transition-all flex items-center gap-2 shadow-lg shadow-blue-500/5'
                            : 'h-11 px-6 rounded-xl font-bold text-sm bg-[#1877F2] text-white hover:bg-[#1565D8] transition-all flex items-center gap-2 shadow-lg shadow-blue-500/20'">
                        <ng-container *ngIf="showAddForm || showEditForm; else addBtnIcon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                            <span>{{ 'CANCEL' | translate }}</span>
                        </ng-container>
                        <ng-template #addBtnIcon>
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 4v16m8-8H4" />
                            </svg>
                            <span>{{ 'ADD_ITEM' | translate }}</span>
                        </ng-template>
                    </button>
                </div>
            </div>

            <!-- Add Item Form (Enhanced) -->
            <div *ngIf="showAddForm" class="mb-10 animate-in slide-in-from-top-4">
                <div
                    class="bg-white rounded-2xl shadow-xl shadow-blue-900/5 border border-[#E2E8F0]/80 overflow-hidden">
                    <!-- Form Header -->
                    <div class="px-8 py-6 border-b border-[#F1F5F9] bg-[#F8FAFC]/50 flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-full bg-[#EFF6FF] text-[#1877F2] flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-lg font-black text-[#0F172A]">{{ 'ADD_ITEM' | translate }}</h3>
                            <p class="text-sm text-[#64748B] font-medium">{{ 'ITEM_DETAILS_MSG' | translate }}</p>
                        </div>
                    </div>

                    <!-- Form Body -->
                    <div class="p-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'ITEM_TITLE' | translate
                                    }} <span class="text-red-500">*</span></label>
                                <input type="text" [(ngModel)]="newItemTitle"
                                    class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm"
                                    [placeholder]="'ITEM_TITLE' | translate">
                                <input type="text" [(ngModel)]="newItemTitleEn"
                                    class="w-full mt-3 h-10 px-3 rounded-md border border-[#E2E8F0] bg-white text-sm placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] outline-none"
                                    [placeholder]="'ITEM_TITLE_EN' | translate">
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'ITEM_TYPE' | translate
                                    }}</label>
                                <div class="relative">
                                    <select [(ngModel)]="newItemType"
                                        class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all appearance-none shadow-sm">
                                        <option value="chapter">{{ 'CHAPTER' | translate }}</option>
                                        <option value="exam">{{ 'PROGRESS_EXAM' | translate }}</option>
                                        <option value="comprehensive">{{ 'COMPREHENSIVE_EXAM' | translate }}</option>
                                    </select>
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                        class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#64748B] pointer-events-none"
                                        fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M19 9l-7 7-7-7" />
                                    </svg>
                                </div>
                            </div>

                            <div *ngIf="newItemType === 'chapter'">
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'LABEL' | translate
                                    }}</label>
                                <input type="text" [(ngModel)]="newItemLabel"
                                    class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm"
                                    placeholder="F1">
                            </div>
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'ITEM_DESC_AR' | translate
                                    }}</label>
                                <input type="text" [(ngModel)]="newItemMeta"
                                    class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm"
                                    [placeholder]="'METADATA' | translate">
                                <input type="text" [(ngModel)]="newItemMetaEn"
                                    class="w-full mt-3 h-10 px-3 rounded-md border border-[#E2E8F0] bg-white text-sm placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] outline-none"
                                    [placeholder]="'ITEM_DESC_EN' | translate">
                            </div>
                        </div>
                    </div>

                    <!-- Form Footer -->
                    <div
                        class="px-8 py-5 bg-[#F8FAFC]/50 border-t border-[#F1F5F9] flex items-center justify-end gap-3">
                        <button (click)="toggleAddForm()"
                            class="px-6 py-2.5 rounded-xl font-bold text-sm text-[#64748B] border border-[#E2E8F0] bg-white hover:bg-[#F1F5F9] hover:text-[#475569] transition-all">{{
                            'CANCEL' | translate }}</button>
                        <button (click)="saveItem()"
                            class="px-8 py-2.5 rounded-xl font-bold text-sm text-white bg-gradient-to-r from-[#1877F2] to-[#1565D8] hover:shadow-lg hover:shadow-blue-500/20 hover:-translate-y-0.5 transition-all">
                            {{ 'SAVE' | translate }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- Inline Edit Form (replaces add form location) -->
            <div *ngIf="showEditForm && editingItem" class="mb-10 animate-in slide-in-from-top-4">
                <div
                    class="bg-white rounded-2xl shadow-xl shadow-blue-900/5 border border-[#E2E8F0]/80 overflow-hidden">
                    <!-- Form Header -->
                    <div class="px-8 py-6 border-b border-[#F1F5F9] bg-[#F8FAFC]/50 flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-full bg-[#EFF6FF] text-[#1877F2] flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-lg font-black text-[#0F172A]">{{ 'EDIT_ITEM' | translate }}</h3>
                            <p class="text-sm text-[#64748B] font-medium">{{ 'UPDATE_ITEM_MSG' | translate }}</p>
                        </div>
                    </div>

                    <!-- Form Body -->
                    <div class="p-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'ITEM_TITLE' | translate
                                    }} <span class="text-red-500">*</span></label>
                                <input type="text" [(ngModel)]="editItemTitle"
                                    class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm"
                                    [placeholder]="'ITEM_TITLE' | translate">
                                <input type="text" [(ngModel)]="editItemTitleEn"
                                    class="w-full mt-3 h-10 px-3 rounded-md border border-[#E2E8F0] bg-white text-sm placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] outline-none"
                                    [placeholder]="'ITEM_TITLE_EN' | translate">
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'ITEM_TYPE' | translate
                                    }}</label>
                                <div class="relative">
                                    <select [(ngModel)]="editItemType"
                                        class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all appearance-none shadow-sm">
                                        <option value="chapter">{{ 'CHAPTER' | translate }}</option>
                                        <option value="exam">{{ 'PROGRESS_EXAM' | translate }}</option>
                                        <option value="comprehensive">{{ 'COMPREHENSIVE_EXAM' | translate }}</option>
                                    </select>
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                        class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#64748B] pointer-events-none"
                                        fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M19 9l-7 7-7-7" />
                                    </svg>
                                </div>
                            </div>

                            <div *ngIf="editItemType === 'chapter'">
                                <label class="block text-sm font-bold text-[#475569] mb-2">{{ 'LABEL' | translate
                                    }}</label>
                                <input type="text" [(ngModel)]="editItemLabel"
                                    class="w-full h-12 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] text-sm font-bold placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm"
                                    placeholder="F1">
                            </div>
                        </div>
                    </div>

                    <!-- Form Footer -->
                    <div
                        class="px-8 py-5 bg-[#F8FAFC]/50 border-t border-[#F1F5F9] flex items-center justify-end gap-3">
                        <button (click)="cancelEdit()"
                            class="px-6 py-2.5 rounded-xl font-bold text-sm text-[#64748B] border border-[#E2E8F0] bg-white hover:bg-[#F1F5F9] hover:text-[#475569] transition-all">{{
                            'CANCEL' | translate }}</button>
                        <button (click)="updateItem()"
                            class="px-8 py-2.5 rounded-xl font-bold text-sm text-white bg-gradient-to-r from-[#1877F2] to-[#1565D8] hover:shadow-lg hover:shadow-blue-500/20 hover:-translate-y-0.5 transition-all">
                            {{ 'SAVE_CHANGES' | translate }}
                        </button>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div *ngIf="timelineData.length === 0 && !showAddForm"
                class="flex flex-col items-center justify-center py-20 text-center">
                <div class="w-24 h-24 bg-[#F1F5F9] rounded-full flex items-center justify-center mb-6">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-[#94A3B8]" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-[#0F172A] mb-2">{{ 'NO_CONTENT_ADDED' | translate }}</h3>
                <p class="text-[#64748B] mb-8">{{ 'START_ADDING_MSG' | translate }}</p>
                <button (click)="toggleAddForm()"
                    class="h-11 px-6 rounded-xl font-bold text-sm bg-[#1877F2] text-white hover:bg-[#1565D8] transition-all flex items-center gap-2 shadow-lg shadow-blue-500/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    <span>{{ 'ADD_ITEM' | translate }}</span>
                </button>
            </div>

            <!-- Timeline Container -->
            <div class="relative pl-10" *ngIf="timelineData.length > 0">
                <!-- Vertical Dashed Line -->
                <div class="absolute top-6 bottom-0 right-[27px] w-px border-r-2 border-dashed border-[#E2E8F0]"></div>

                <div class="space-y-6" cdkDropList cdkDropListLockAxis="y" (cdkDropListDropped)="onDrop($event)">
                    <div *ngFor="let item of timelineData; let i = index" class="relative flex items-start gap-8 group"
                        cdkDrag cdkDragLockAxis="y" [cdkDragConstrainPosition]="dragConstraint">

                        <!-- Timeline Node Icon -->
                        <div class="relative z-10 flex-shrink-0">
                            <ng-container [ngSwitch]="item.type">
                                <div *ngSwitchCase="'chapter'"
                                    class="w-14 h-14 rounded-full bg-white border-2 border-[#E2E8F0] flex items-center justify-center text-[#64748B] shadow-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                    </svg>
                                </div>
                                <div *ngSwitchCase="'exam'"
                                    class="w-14 h-14 rounded-full bg-white border-2 border-[#1877F2] flex items-center justify-center text-[#1877F2] shadow-sm ring-4 ring-[#EFF6FF]">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div *ngSwitchCase="'comprehensive'"
                                    class="w-14 h-14 rounded-full bg-[#FFFBEB] border-2 border-[#F59E0B] flex items-center justify-center text-[#F59E0B] shadow-sm ring-4 ring-[#FFF7ED]">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                    </svg>
                                </div>
                            </ng-container>
                        </div>

                        <!-- Card Content -->
                        <div class="flex-1 rounded-2xl border transition-all duration-200 p-5 flex items-center justify-between"
                            [ngClass]="{
                    'bg-white border-[#FEF3C7] shadow-[0_2px_8px_rgba(245,158,11,0.05)] hover:shadow-[0_4px_12px_rgba(245,158,11,0.1)]': item.type === 'comprehensive',
                    'bg-white border-[#E2E8F0] shadow-sm cursor-pointer hover:shadow-lg hover:shadow-blue-500/5 hover:-translate-y-0.5 hover:border-[#DBEAFE] hover:bg-[#F8FAFC] active:scale-[0.98] active:border-[#1877F2]': item.type === 'chapter',
                    'bg-white border-[#E2E8F0] shadow-sm hover:shadow-md': item.type === 'exam'
                  }">
                            <div class="flex items-center gap-4 flex-1">
                                <!-- Chapter Label -->
                                <div *ngIf="item.type === 'chapter'"
                                    class="w-12 h-12 rounded-lg bg-[#F1F5F9] border border-[#E2E8F0] flex items-center justify-center font-black text-[#64748B] text-lg transition-colors group-hover:bg-[#EFF6FF] group-hover:text-[#1877F2] group-hover:border-[#DBEAFE]">
                                    {{ item.label }}
                                </div>

                                <div class="flex-1">
                                    <h3 class="font-bold text-lg mb-1 transition-colors" [ngClass]="{
                            'text-[#0F172A] group-hover:text-[#1877F2]': item.type === 'chapter',
                            'text-[#1877F2]': item.type === 'exam',
                            'text-[#B45309]': item.type === 'comprehensive'
                          }">
                                        {{ translationService.current === 'ar' ? item.title : (item.titleEn ||
                                        item.title) }}
                                    </h3>

                                    <div class="flex items-center gap-3">
                                        <span class="text-sm font-medium text-[#94A3B8] flex items-center gap-1.5">
                                            <span *ngIf="item.type === 'chapter'"
                                                class="w-1 h-1 rounded-full bg-[#CBD5E1]"></span>
                                            {{ translationService.current === 'ar' ? item.meta : (item.metaEn ||
                                            item.meta) }}
                                        </span>

                                        <!-- Exam specific link -->
                                        <ng-container *ngIf="item.type === 'exam' || item.type === 'comprehensive'">
                                            <span class="w-1 h-1 rounded-full bg-[#CBD5E1]"></span>
                                            <span class="text-sm font-bold cursor-pointer hover:underline"
                                                [ngClass]="item.type === 'comprehensive' ? 'text-[#F59E0B] bg-[#FFFBEB] px-2 py-0.5 rounded' : 'text-[#1877F2]'">
                                                {{ translationService.current === 'ar' ? item.examTypeLabel : (item.examTypeLabelEn || item.examTypeLabel) }}
                                            </span>
                                        </ng-container>
                                    </div>
                                </div>

                                <!-- Chevron Arrow - Only for chapters -->
                                <div *ngIf="item.type === 'chapter'"
                                    class="opacity-0 group-hover:opacity-100 transition-all duration-200 group-hover:-translate-x-1">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                        class="w-6 h-6 text-[#94A3B8] group-hover:text-[#1877F2]" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M15 19l-7-7 7-7" />
                                    </svg>
                                </div>
                            </div>

                            <!-- Right Side Actions -->
                            <div class="flex items-center gap-4 mr-4">
                                <!-- Status Badge -->
                                <div *ngIf="item.status" class="px-3 py-1.5 rounded-lg text-xs font-bold border"
                                    [ngClass]="item.status === 'published' ? 'bg-[#ECFDF5] text-[#10B981] border-[#D1FAE5]' : 'bg-[#F1F5F9] text-[#64748B] border-[#E2E8F0]'">
                                    {{ (item.status === 'published' ? 'PUBLISHED' : 'DRAFT') | translate }}
                                </div>

                                <!-- Actions -->
                                <div class="flex items-center gap-1 border-r border-[#E2E8F0] pr-4 mr-1">
                                    <button (click)="openEditModal(item)"
                                        class="w-9 h-9 rounded-lg flex items-center justify-center text-[#94A3B8] hover:text-[#1877F2] hover:bg-[#EFF6FF] transition-all">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                        </svg>
                                    </button>
                                    <button (click)="openDeleteModal(item.id)"
                                        class="w-9 h-9 rounded-lg flex items-center justify-center text-[#94A3B8] hover:text-[#EF4444] hover:bg-[#FEF2F2] transition-all">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Delete Modal -->
    <div *ngIf="showDeleteModal" class="fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity" (click)="cancelDelete()"></div>
        <div
            class="relative bg-white rounded-2xl shadow-xl border border-[#E2E8F0] w-full max-w-md p-6 transform transition-all animate-in zoom-in-95">
            <div class="flex flex-col items-center text-center">
                <div class="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-red-500" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-[#0F172A] mb-2">{{ 'DELETE_CONFIRM_TITLE' | translate }}</h3>
                <p class="text-[#64748B] mb-8">{{ 'DELETE_CONFIRM_MSG' | translate }}</p>
                <div class="flex items-center gap-3 w-full">
                    <button (click)="cancelDelete()"
                        class="flex-1 h-11 rounded-xl font-bold text-sm bg-white border border-[#E2E8F0] text-[#64748B] hover:bg-[#F8FAFC] transition-colors">{{
                        'CANCEL' | translate }}</button>
                    <button (click)="confirmDelete()"
                        class="flex-1 h-11 rounded-xl font-bold text-sm bg-red-500 text-white hover:bg-red-600 shadow-lg shadow-red-500/20 transition-colors">{{
                        'DELETE' | translate }}</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal (Professional Glassmorphism) -->
    <div *ngIf="showEditModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <!-- Backdrop with blur -->
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity" (click)="cancelEdit()"></div>

        <!-- Modal Card -->
        <div
            class="relative bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl ring-1 ring-black/5 w-full max-w-2xl transform transition-all animate-in zoom-in-95 slide-in-from-bottom-5">

            <!-- Header -->
            <div class="px-8 py-6 border-b border-[#E2E8F0]/80 flex items-center justify-between">
                <div>
                    <h3 class="text-xl font-black text-[#0F172A]">{{ 'EDIT_ITEM' | translate }}</h3>
                    <p class="text-[#64748B] text-sm mt-1">{{ 'UPDATE_ITEM_MSG' | translate }}</p>
                </div>
                <button (click)="cancelEdit()"
                    class="w-8 h-8 rounded-full hover:bg-[#F1F5F9] flex items-center justify-center text-[#94A3B8] transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Body -->
            <div class="p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="col-span-1 md:col-span-2">
                        <label class="block text-sm font-bold text-[#64748B] mb-2">{{ 'ITEM_TITLE' | translate }} <span
                                class="text-red-500">*</span></label>
                        <input type="text" [(ngModel)]="editItemTitle"
                            class="w-full h-11 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm placeholder:text-[#94A3B8]/70"
                            [placeholder]="'ITEM_TITLE' | translate">
                        <input type="text" [(ngModel)]="editItemTitleEn"
                            class="w-full mt-3 h-10 px-3 rounded-md border border-[#E2E8F0] bg-white text-sm placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] outline-none"
                            [placeholder]="'ITEM_TITLE_EN' | translate">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-[#64748B] mb-2">{{ 'ITEM_TYPE' | translate }}</label>
                        <select [(ngModel)]="editItemType"
                            class="w-full h-11 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm appearance-none">
                            <option value="chapter">{{ 'CHAPTER' | translate }}</option>
                            <option value="exam">{{ 'PROGRESS_EXAM' | translate }}</option>
                            <option value="comprehensive">{{ 'COMPREHENSIVE_EXAM' | translate }}</option>
                        </select>
                    </div>

                    <div *ngIf="editItemType === 'chapter'">
                        <label class="block text-sm font-bold text-[#64748B] mb-2">{{ 'LABEL' | translate }}</label>
                        <input type="text" [(ngModel)]="editItemLabel"
                            class="w-full h-11 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm placeholder:text-[#94A3B8]/70"
                            placeholder="F1">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-[#64748B] mb-2">{{ 'METADATA' | translate }}</label>
                        <input type="text" [(ngModel)]="editItemMeta"
                            class="w-full h-11 px-4 rounded-xl border-2 border-[#64748B] bg-[#F8FAFC] bg-white focus:border-[#1877F2] focus:ring-4 focus:ring-blue-500/10 outline-none transition-all shadow-sm placeholder:text-[#94A3B8]/70"
                            [placeholder]="'METADATA' | translate">
                        <input type="text" [(ngModel)]="editItemMetaEn"
                            class="w-full mt-3 h-10 px-3 rounded-md border border-[#E2E8F0] bg-white text-sm placeholder:text-[#94A3B8]/70 focus:border-[#1877F2] outline-none"
                            [placeholder]="'ITEM_DESC_EN' | translate">
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div
                class="px-8 py-6 bg-[#F8FAFC]/50 border-t border-[#E2E8F0]/80 flex items-center justify-end gap-3 rounded-b-2xl">
                <button (click)="cancelEdit()"
                    class="px-6 py-2.5 rounded-xl font-bold text-sm text-[#64748B] border border-[#E2E8F0] bg-white hover:bg-[#F8FAFC] hover:border-[#CBD5E1] transition-all shadow-sm">{{
                    'CANCEL' | translate }}</button>
                <button (click)="updateItem()"
                    class="px-8 py-2.5 rounded-xl font-bold text-sm text-white bg-gradient-to-r from-[#1877F2] to-[#1565D8] hover:shadow-lg hover:shadow-blue-500/20 hover:-translate-y-0.5 transition-all">
                    {{ 'SAVE_CHANGES' | translate }}
                </button>
            </div>
        </div>
    </div>
</div>